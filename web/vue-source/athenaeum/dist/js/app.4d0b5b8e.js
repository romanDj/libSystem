(function(e){function t(t){for(var r,u,i=t[0],c=t[1],s=t[2],p=0,d=[];p<i.length;p++)u=i[p],Object.prototype.hasOwnProperty.call(o,u)&&o[u]&&d.push(o[u][0]),o[u]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,u=1;u<n.length;u++){var c=n[u];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function u(e){return i.p+"js/"+({}[e]||e)+"."+{"chunk-2d0c5b16":"7d190f96","chunk-2d0e5371":"65466783","chunk-2d0e922d":"73f201f0","chunk-2d2086b7":"5daecdcc","chunk-2d217357":"5878dce0","chunk-2d21a3d2":"80456a27"}[e]+".js"}function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=o[e]=[t,r]}));t.push(n[2]=r);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=u(e);var s=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(p);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",s.name="ChunkLoadError",s.type=r,s.request=a,n[1](s)}o[e]=void 0}};var p=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="../vue-source/athenaeum/dist/",i.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var p=0;p<c.length;p++)t(c[p]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("nav",{staticClass:"navbar navbar-expand-lg navbar-light bg-light"},[n("div",{staticClass:"container-fluid"},[n("a",{staticClass:"navbar-brand",attrs:{href:"/"}},[e._v("LibSystem")]),n("div",{staticClass:"navbar-collapse"},[n("ul",{staticClass:"navbar-nav mr-auto mb-2 mb-lg-0"},[e._l(e.menu,(function(t,r){return n("li",{key:"menuitem"+r,staticClass:"nav-item"},[n("a",{staticClass:"nav-link",attrs:{href:t.route},on:{click:function(n){return n.preventDefault(),function(){return e.goLink(t.route)}()}}},[e._v(" "+e._s(t.title)+" ")])])})),e.checkUser?n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",attrs:{href:"/"},on:{click:function(t){return t.preventDefault(),e.logout(t)}}},[e._v("Выйти")])]):e._e()],2)])])]),n("div",[n("RouterView")],1)])},a=[],u={name:"App",components:{},data:function(){return{}},computed:{checkUser:function(){return this.$store.getters.checkAuth},menu:function(){return this.$store.getters.checkAuth?[{title:"Книги",route:"/books"},{title:"Авторы",route:"/authors"}]:[{title:"Авторизация",route:"/login"},{title:"Регистрация",route:"/registration"}]}},methods:{goLink:function(e){this.$router.push(e)},logout:function(){this.$store.dispatch("logoutUser"),this.$router.push("/login")}}},i=u,c=n("2877"),s=Object(c["a"])(i,o,a,!1,null,null,null),p=s.exports,l=n("8c4f"),d=n("2f62"),f=(n("96cf"),n("1da1")),h=(n("8e6e"),n("ac6a"),n("456d"),n("ade3")),v=(n("a481"),n("3b2b"),n("4917"),n("d4ec")),m=n("bee2");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){Object(h["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g="/v1",w=function(){function e(){Object(v["a"])(this,e)}return Object(m["a"])(e,null,[{key:"getCookie",value:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}},{key:"setCookie",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=k({path:"/"},n),n.expires instanceof Date&&(n.expires=n.expires.toUTCString());var r=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var o in n){r+="; "+o;var a=n[o];!0!==a&&(r+="="+a)}document.cookie=r}},{key:"deleteCookie",value:function(e){this.setCookie(e,"",{"max-age":-1})}},{key:"sendq",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,a,u,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"get",r=i.length>2&&void 0!==i[2]?i[2]:null,o=!(i.length>3&&void 0!==i[3])||i[3],n=n.toUpperCase(),a={url:t,method:n,mode:"cors",headers:{"Content-Type":"application/json"}},r&&(a.body=JSON.stringify(r)),o&&(a.headers.Authorization="Bearer ".concat(this.getCookie("access_token"))),e.next=9,fetch("".concat(g).concat(t),a);case 9:if(u=e.sent,!u.ok){e.next=22;break}return e.prev=11,e.next=14,u.json();case 14:return e.t0=e.sent,e.t1=u,e.abrupt("return",{data:e.t0,response:e.t1});case 19:return e.prev=19,e.t2=e["catch"](11),e.abrupt("return",{response:u});case 22:return e.next=24,u.json();case 24:throw e.t3=e.sent,e.t4=u,{data:e.t3,response:e.t4};case 27:case"end":return e.stop()}}),e,this,[[11,19]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),y={login:function(e){var t=e.login,n=e.password;return w.sendq("/user/login","post",{login:t,password:n},!1)},registration:function(e){var t=e.login,n=e.password,r=e.fio;return w.sendq("/user/register","post",{login:t,password:n,fio:r},!1)},profile:function(){return w.sendq("/user/profile","get")}},O={Book:{list:function(){return w.sendq("/athenaeum/books?expand=author")},get:function(e){return w.sendq("/athenaeum/books/"+e+"?expand=author")},remove:function(e){return w.sendq("/athenaeum/books/"+e,"delete")},add:function(e){var t=e.title,n=e.description,r=e.author_id;return w.sendq("/athenaeum/books","post",{title:t,description:n,author_id:r})},edit:function(e){var t=e.id,n=e.title,r=e.description,o=e.author_id;return w.sendq("/athenaeum/books/"+t,"put",{title:n,description:r,author_id:o})}},Author:{list:function(){return w.sendq("/athenaeum/authors?expand=books")},get:function(e){return w.sendq("/athenaeum/authors/"+e+"?expand=books")},remove:function(e){return w.sendq("/athenaeum/authors/"+e,"delete")},add:function(e){var t=e.fio,n=e.description;return w.sendq("/athenaeum/authors","post",{fio:t,description:n})},edit:function(e){var t=e.id,n=e.fio,r=e.description;return w.sendq("/athenaeum/authors/"+t,"put",{fio:n,description:r})}}},x={state:{token:w.getCookie("access_token")||null,user:null},mutations:{setToken:function(e,t){e.token=t},setUser:function(e,t){e.user=t}},getters:{user:function(e){return e.user},checkAuth:function(e){return null!==e.token}},actions:{loginUser:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,o=n.login,a=n.password,e.prev=2,e.next=5,y.login({login:o,password:a});case 5:u=e.sent,u.data.status&&(w.setCookie("access_token",u.data.token),r("setToken",u.data.token)),e.next=12;break;case 9:throw e.prev=9,e.t0=e["catch"](2),e.t0;case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));function t(t,n){return e.apply(this,arguments)}return t}(),logoutUser:function(e,t){var n=e.commit;w.deleteCookie("access_token"),n("setToken",null),n("setUser",null)},registerUser:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,r=n.login,o=n.password,a=n.fio,e.prev=2,e.next=5,y.registration({login:r,password:o,fio:a});case 5:u=e.sent,u.data.status&&console.log(u.data),e.next=12;break;case 9:throw e.prev=9,e.t0=e["catch"](2),e.t0;case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));function t(t,n){return e.apply(this,arguments)}return t}()}};n("7514");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(h["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A={state:{authors:null,books:null},getters:{authors:function(e){return e.authors},books:function(e){return e.books}},mutations:{setAuthors:function(e,t){e.authors=t},addAuthor:function(e,t){e.authors.push(t)},removeAuthor:function(e,t){e.authors=e.authors.filter((function(e){return e.id!=t}))},editAuthor:function(e,t){e.authors=e.authors.map((function(e){return e.id==t.id?R(R({},e),t):e}))},setBooks:function(e,t){e.books=t},addBook:function(e,t){e.books.push(t)},removeBook:function(e,t){e.books=e.books.filter((function(e){return e.id!=t}))},editBook:function(e,t){e.books=e.books.map((function(e){return e.id==t.id?R(R({},e),t):e}))}},actions:{loadAuthors:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,e.next=4,O.Author.list();case 4:r=e.sent,n("setAuthors",r.data),e.next=11;break;case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}(),getAuthor:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.prev=1,e.next=4,O.Author.get(n);case 4:r=e.sent,console.log(r.data),e.next=11;break;case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t,n){return e.apply(this,arguments)}return t}(),addAuthor:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,o=n.fio,a=n.description,e.prev=2,e.next=5,O.Author.add({fio:o,description:a});case 5:u=e.sent,r("addAuthor",u.data),e.next=12;break;case 9:throw e.prev=9,e.t0=e["catch"](2),e.t0;case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));function t(t,n){return e.apply(this,arguments)}return t}(),editAuthor:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,o=n.id,a=n.fio,u=n.description,e.prev=2,e.next=5,O.Author.edit({id:o,fio:a,description:u});case 5:i=e.sent,r("editAuthor",i.data),e.next=12;break;case 9:throw e.prev=9,e.t0=e["catch"](2),e.t0;case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));function t(t,n){return e.apply(this,arguments)}return t}(),removeAuthor:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.prev=1,e.next=4,O.Author.remove(n);case 4:o=e.sent,204==o.response.status&&r("removeAuthor",n),e.next=11;break;case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t,n){return e.apply(this,arguments)}return t}(),loadBooks:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,e.next=4,O.Book.list();case 4:r=e.sent,n("setBooks",r.data),e.next=11;break;case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}(),addBook:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,i,c,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,o=t.state,a=n.title,u=n.description,i=n.author_id,e.prev=2,e.next=5,O.Book.add({title:a,description:u,author_id:i});case 5:c=e.sent,s=o.authors.find((function(e){return e.id==i})),r("addBook",R(R({},c.data),{},{author:s?{id:s.id,fio:s.fio,description:s.description}:null})),e.next=13;break;case 10:throw e.prev=10,e.t0=e["catch"](2),e.t0;case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));function t(t,n){return e.apply(this,arguments)}return t}(),editBook:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,i,c,s,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,o=t.state,a=n.id,u=n.title,i=n.description,c=n.author_id,e.prev=2,e.next=5,O.Book.edit({id:a,title:u,description:i,author_id:c});case 5:s=e.sent,p=o.authors.find((function(e){return e.id==c})),r("editBook",R(R({},s.data),{},{author:p?{id:p.id,fio:p.fio,description:p.description}:null})),e.next=13;break;case 10:throw e.prev=10,e.t0=e["catch"](2),e.t0;case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));function t(t,n){return e.apply(this,arguments)}return t}(),removeBook:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.prev=1,e.next=4,O.Book.remove(n);case 4:o=e.sent,204==o.response.status&&r("removeBook",n),e.next=11;break;case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t,n){return e.apply(this,arguments)}return t}()}};r["a"].use(d["a"]);var P=new d["a"].Store({modules:{athenaeum:A,user:x}});r["a"].use(l["a"]);var _=function(e,t,n){P.getters.checkAuth?n("/"):n()},C=[{path:"/",name:"Home",component:function(){return n.e("chunk-2d21a3d2").then(n.bind(null,"bb51"))}},{path:"/login",name:"Login",component:function(){return n.e("chunk-2d2086b7").then(n.bind(null,"a55b"))},beforeEnter:_},{path:"/registration",name:"Registration",component:function(){return n.e("chunk-2d0c5b16").then(n.bind(null,"3fd1"))}},{path:"/profile",name:"Profile",component:function(){return n.e("chunk-2d217357").then(n.bind(null,"c66d"))}},{path:"/books",name:"Books",component:function(){return n.e("chunk-2d0e922d").then(n.bind(null,"8bf3"))}},{path:"/authors",name:"Authors",component:function(){return n.e("chunk-2d0e5371").then(n.bind(null,"9411"))}}],B=new l["a"]({mode:"hash",base:"/",routes:C});n("ab8b");r["a"].config.productionTip=!1,new r["a"]({router:B,store:P,render:function(e){return e(p)}}).$mount("#app")}});
//# sourceMappingURL=app.4d0b5b8e.js.map